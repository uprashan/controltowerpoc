{
	"name": "df_dataverse_to_blob storage",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "Dataverse_DS",
						"type": "DatasetReference"
					},
					"name": "dataversesource",
					"description": "Import data from blob storage"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "Dataset_Blobstorage",
						"type": "DatasetReference"
					},
					"name": "blobstoragesink",
					"rejectedDataLinkedService": {
						"referenceName": "AzureControlTowerFiles",
						"type": "LinkedServiceReference"
					}
				}
			],
			"transformations": [
				{
					"name": "Select"
				}
			],
			"scriptLines": [
				"source(output(",
				"          owneridyominame as string,",
				"          craf2_receiptnumber as string,",
				"          craf2_odmpartnumber as string,",
				"          craf2_tier2porequestquantity as string,",
				"          craf2_tier2salesorderquantity as string,",
				"          craf2_releasenumber as string,",
				"          craf2_tier2targetleadtimeday as string,",
				"          createdbyname as string,",
				"          createdonbehalfbyyominame as string,",
				"          craf2_tier2pocommitdateetd as string,",
				"          craf2_businessunitid as string,",
				"          owneridtype as string,",
				"          craf2_transitleadtime as string,",
				"          modifiedon as timestamp,",
				"          craf2_tier2shipmentreceiptquantity as string,",
				"          craf2_tier2ponumber as string,",
				"          craf2_pocreationdate as timestamp,",
				"          craf2_shipmentreceiptquantity as string,",
				"          craf2_remainingopenpoquantity as string,",
				"          statuscodename as string,",
				"          modifiedbyname as string,",
				"          craf2_manufacturingpartnumber as string,",
				"          craf2_tier2shipmentreceiptdategr as string,",
				"          craf2_supplierallocation as string,",
				"          craf2_tier2salesorderno as string,",
				"          craf2_manufacturername as string,",
				"          craf2_potype as string,",
				"          craf2_closeddate as string,",
				"          modifiedonbehalfbyname as string,",
				"          craf2_reportdate as timestamp,",
				"          statuscode as integer,",
				"          craf2_postprocessing_lead_time as string,",
				"          craf2_canceldate as string,",
				"          craf2_targetleadtime as string,",
				"          craf2_ptp as string,",
				"          owneridname as string,",
				"          importsequencenumber as integer,",
				"          modifiedbyyominame as string,",
				"          craf2_ncnr as string,",
				"          craf2_addressforcomponentsupplier as string,",
				"          craf2_tier2pocreationdate as timestamp,",
				"          craf2_polineitem as string,",
				"          craf2_tier2salesorderlineitem as string,",
				"          craf2_ponumber as string,",
				"          statecodename as string,",
				"          craf2_criticalshortageflag as string,",
				"          utcconversiontimezonecode as integer,",
				"          craf2_tier2poschedulelineitem as string,",
				"          craf2_subconsite as string,",
				"          craf2_pocommitdate as timestamp,",
				"          modifiedonbehalfbyyominame as string,",
				"          craf2_tier2intelpartnumberidentifier as string,",
				"          craf2_distiindicator as string,",
				"          craf2_name as string,",
				"          craf2_subconid as string,",
				"          craf2_shipmentreceiptdate as string,",
				"          craf2_porequestquantity as string,",
				"          craf2_addressfordisti1name as string,",
				"          timezoneruleversionnumber as integer,",
				"          craf2_customorstandard as string,",
				"          craf2_manufacturerid as string,",
				"          overriddencreatedon as timestamp,",
				"          statecode as integer,",
				"          craf2_intelpartnumberidentifier as string,",
				"          craf2_tier2polineitem as string,",
				"          craf2_componentsupplierid as string,",
				"          createdbyyominame as string,",
				"          createdon as timestamp,",
				"          craf2_suppliermoq as string,",
				"          versionnumber as long,",
				"          craf2_intelpartnumber as string,",
				"          craf2_componentunitpricing as string,",
				"          craf2_oct_intel_modelid as string,",
				"          craf2_ordershipfromlocation as string,",
				"          craf2_ipndescription as string,",
				"          craf2_postprocessingleadtime as string,",
				"          craf2_componentsuppliername as string,",
				"          craf2_addressfordisti as string,",
				"          craf2_idmipo as string,",
				"          craf2_distributorname as string,",
				"          craf2_tier2porequestdaterdd as string,",
				"          craf2_porequestdate as string,",
				"          craf2_poschedulelineitem as string,",
				"          craf2_distributorid as string,",
				"          craf2_tier2pocommitdateeta as string,",
				"          craf2_pocommitquantity as string,",
				"          createdonbehalfbyname as string,",
				"          createdonbehalfby as string,",
				"          owninguser as string,",
				"          modifiedby as string,",
				"          modifiedonbehalfby as string,",
				"          craf2_addressfordisti1 as string,",
				"          ownerid as string,",
				"          {@odata.etag} as string,",
				"          createdby as string,",
				"          owningbusinessunit as string,",
				"          owningteam as string",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false) ~> dataversesource",
				"dataversesource select(mapColumn(",
				"          each(match(type=='string'),",
				"               right($$,length($$)-6) = $$)",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> Select",
				"Select sink(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     partitionFileNames:['Intel Model.csv'],",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true,",
				"     partitionBy('hash', 1)) ~> blobstoragesink"
			]
		}
	}
}